# Предсказание рисков сердечного приступа

## Обзор

Это веб-приложение машинного обучения, созданное с использованием FastAPI, которое прогнозирует риск сердечных приступов на основе данных о здоровье пациента.  
Система обрабатывает CSV-файлы с медицинскими данными и возвращает прогнозы риска с помощью обученной модели.  
Приложение имеет веб-интерфейс для загрузки файлов.

## Архитектура системы

### Бэкенд-фреймворк
- **FastAPI**: современный Python-фреймворк с автоматической документацией API, поддержкой аннотаций типов и высокой производительностью  
- **Асинхронная обработка**: эффективная работа с загрузкой файлов и прогнозами  
- **Обслуживание статических файлов**: доступ к загруженным файлам и результатам через смонтированные директории  

### Конвейер машинного обучения
- **Абстракция модели**: централизованный класс `Model` управляет логикой прогнозов и предобработкой данных  
- **Резервный механизм**: система пытается загрузить предобученную модель CatBoost
- **Проверка признаков**: контроль наличия всех 25 необходимых медицинских признаков  
- **Предобработка данных**: кодирование категориальных признаков (пол, диета)

### Обработка файлов
- **Меры безопасности**: проверка файлов, ограничение размера (до 50 МБ), фильтрация по расширениям (.csv)  
- **Временное хранение**: использование папки `tmp/` для загруженных файлов с уникальными именами  

### Фронтенд-интерфейс
- **Шаблонизатор**: Jinja2 для серверной генерации страниц  
- **Адаптивный дизайн**: современный CSS с градиентными фонами и гибкой версткой  
- **Двухстраничный сценарий**: форма загрузки → отображение результатов с краткой статистикой  

### Дизайн API
- **RESTful-эндпоинты**: разделение проверок состояния, загрузки файлов и прогнозов  
- **JSON-ответы**: единый формат для всех API  
- **Обработка загрузки файлов**: поддержка multipart-данных с валидацией  

## Внешние зависимости

### Основные библиотеки
- **FastAPI**: веб-фреймворк и разработка API  
- **Uvicorn**: ASGI-сервер для продакшена  
- **Pandas**: работа с данными и CSV  
- **Scikit-learn**: утилиты для машинного обучения и предобработки  
- **Joblib**: сериализация и загрузка моделей  

### Машинное обучение
- **CatBoost**: основная модель для градиентного бустинга  
- **RandomForest**: резервный классификатор для демонстрации  
- **StandardScaler**: нормализация признаков в конвейере  

### Веб-технологии
- **Jinja2**: генерация HTML-шаблонов  
- **Обслуживание статических файлов**: встроенная поддержка FastAPI  
- **HTML/CSS**: интерфейс с современным стилем  

### Разработка и тестирование
- **Requests**: HTTP-клиент для тестирования API  
- **Python logging**: встроенная система логирования  
- **OS/Path utilities**: операции с файловой системой и путями  

## Инструкция по запуску 
- Клонировать репозиторий
- Развернуть удаленый репозиторий локально на своем устройсвте
- Установить зависимости (pip install -r requirements.txt)
- Перейти в директорию с проектом 
- Вызвать две консоли
- - В первой: python app.py
- - Во второй: curl http://127.0.0.1:8000/health (елси в ответе будет '{"status":"OK","timestamp":"2025-09-20 15:12:36 IST"}%', то все идет как надо)
- Переходим на http://127.0.0.1:8000
- Далее жмём кнопку 'Выбрать файл' и загружаем файл в формате CSV с записями о физиологическом состоянии пациентов 
- Далее нажимаем 'Отправить'
- Открывается новая страница http://127.0.0.1:8000/process и там передается JSON-файл с id пациента и его диагнозом (0 - вне опасности, 1 - опасность есть)


## Примеры 
<img width="403" height="206" alt="image" src="https://github.com/user-attachments/assets/6944c17e-e241-40ad-a5c8-b460d514d87c" />
<img width="1301" height="807" alt="image" src="https://github.com/user-attachments/assets/fce9472f-e3d8-4b31-8be4-c7d2857480a8" />
